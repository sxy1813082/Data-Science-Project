# new_dataset_no = MyCustomDatasetNo(new_data_no["text"], new_data_no["labels"])
        #
        # # Concatenate the new_dataset with the existing raw_dataset
        # raw_dataset_noexp_no["train"] = data_utils.ConcatDataset([raw_dataset_noexp_no["train"], new_dataset_no])
        # # Convert the concatenated dataset to a list of tuples
        # concatenated_samples = list(raw_dataset_noexp_no["train"])
        #
        # # Separate the data into separate lists
        # text_list, labels_list = zip(*concatenated_samples)
        #
        # # Create a dictionary with the separate lists
        # subset_1_dict = {
        #     "text": list(text_list),
        #     "labels": list(labels_list)
        # }
        #
        # # Convert the dictionary to a DataFrame
        # subset_1_df = pd.DataFrame(subset_1_dict)
        # subset_1_csv_path = "./data/dataset_noexp_no.csv"
        # subset_1_df.to_csv(subset_1_csv_path, index=False)
#
        # raw_dataset_noexp_train = raw_dataset_noexp["train"]
        # raw_dataset_noexp = DatasetDict(
        #     {"train": [data for i, data in enumerate(raw_dataset_noexp_train) if i not in sampled_indices]})
        #
        # # Convert the dataset to a list
        # concatenated_samples = list(raw_dataset_noexp["train"])
        # # Separate the data into separate lists
        # text_list, labels_list = zip(*concatenated_samples)
        # # Create a dictionary with the separate lists
        # subset_1_dict = {
        #     "text": list(text_list),
        #     "labels": list(labels_list)
        # }
        # # Convert the dictionary to a DataFrame
        # subset_1_df = pd.DataFrame(subset_1_dict)
        # subset_1_csv_path = "./data/dataset_noexp.csv"
        # subset_1_df.to_csv(subset_1_csv_path, index=False)
        # # Load the CSV file into a DatasetDict
E:\Desktop\大三上\人工智能\venv\Scripts\python.exe "D:/Bristol course/Data Science Dissertation/ExpBERT lab and thesis/BERT-IE-main/BERT-IE-main/Whole_train.py"
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-325fb29403e27f4c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-325fb29403e27f4c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 142.84it/s]
100%|██████████| 1/1 [00:00<00:00, 53.56it/s]
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 142.90it/s]
100%|██████████| 1/1 [00:00<00:00, 111.15it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-11371a7b382b30da/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-11371a7b382b30da/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-aad372f2cfe22d42/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 166.52it/s]
100%|██████████| 1/1 [00:00<00:00, 81.85it/s]
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-aad372f2cfe22d42/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
690
690
embedding begin
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
torch.Size([3726, 30])
103.5
torch.Size([1035, 108])
./embeddings/NEW_bertie_embeddings_textattack/bert-base-uncased-MNLI_subset_1.pt
classify begin
724
155
156
  0%|          | 0/4 [00:00<?, ?it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
62it [00:05, 15.46it/s]                      bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
150it [00:17, 10.37it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
254it [00:29, 10.68it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
304it [00:41,  7.11it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
epoch number 3
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
test epoch results {'accuracy': 0.7290322580645161, 'f1_weighted': 0.6299539170506913, 'f1_macro': 0.18136390358612578, 'f1': array([0.84656085, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.78571429]), 'precision': array([0.74074074, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.70212766]), 'recall': array([0.98765432, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.89189189])}
[auto tweet]  Deadly monsoon hits India, Nepal http
Photo: breakingnews: At least 180 dead in monsoon flooding in Nepal, India AP: The death toll from three... http
Latest : Floods wreak havoc in Uttarakahand, Assam, Uttar Pradesh, Bihar; lakhs affected - Zee New... http Indian News
Oh, I'm open. I can't even prove there aren't unicorn herds on distant planets that won't show up here, tomorrow.  cont…
[News Update] | 24 Killed, Including 7 In Their Sleep As Landslide Hit India http |Via Information Ng
364it [00:54,  6.65it/s]
At least 9 killed as Rapti Ganga Express rams autorickshaw in Bihar: At least nine people we... http via
Just an FYI. Just because you have a bible verse in your twitter bio doesn't mean it makes up for you being a whore smiling face
UP floods hit over 1,000 villages, death toll 28  http
Latest : Bihar: 21 of a family killed as train hits auto - Hindustan Times: Times of IndiaBihar: 2... http Indian News
Nepal | Many dead in Nepal and India floods - &amp;#8230;  torrential rain in Nepal and northern India.         In Ne... http
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-4b96c0e1eab8aa54/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 138.22it/s]
100%|██████████| 1/1 [00:00<00:00, 90.66it/s]
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-4b96c0e1eab8aa54/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-6e8966bd14bff0c5/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 166.67it/s]
100%|██████████| 1/1 [00:00<00:00, 110.57it/s]
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-6e8966bd14bff0c5/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-fa3784e6ee27a635/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-fa3784e6ee27a635/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 142.89it/s]
100%|██████████| 1/1 [00:00<00:00, 102.88it/s]
embedding begin
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
torch.Size([3762, 30])
104.5
torch.Size([1045, 108])
./embeddings/NEW_bertie_embeddings_textattack/bert-base-uncased-MNLI_subset_1.pt
classify begin
731
157
157
  0%|          | 0/4 [00:00<?, ?it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
 25%|██▌       | 1/4 [00:06<00:19,  6.37s/it]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
89it [00:06, 30.21it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
176it [00:19, 11.31it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
271it [00:31, 10.34it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
360it [00:45,  9.01it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
epoch number 3
368it [00:55,  9.01it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
test epoch results {'accuracy': 0.7006369426751592, 'f1_weighted': 0.5952212449027735, 'f1_macro': 0.17489711934156377, 'f1': array([0.83597884, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.73809524]), 'precision': array([0.72477064, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.64583333]), 'recall': array([0.9875    , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.86111111])}
THE NATIONAL WEATHER SERVICE IN  INDIANA HAS ISSUED AN FLOOD ADVISORY FOR WABASH COUNTY UNTIL 2:30 PM. http
the best part of waking up musical notesmusical note
3:03pm-Flash Flood Warning til 6pm for US95 from Indian Springs to Lee Canyon Rd.   http
Deadly monsoon hits India, Nepal: Dozens of people have been killed in flooding in nort... http
.@CPFC fined for breaching  rules over making efforts to obtain the Cardiff line-up before their meeting in Apr…
Many dead in Nepal and India floods, REAL TALK http
Nepal and India begin relief efforts as monsoon floods claim at least 180 lives: Nepalese villagers carry thei... http
Odisha  Death toll rises to 45, over 33 lakh people affected | http | India Infoblaze I N D
Pakistan Dunya Floods kill 45 in eastern India: official: NEW DELHI (AFP) - Flooding in eastern India has killed 45 people and disp...
Nepal released water into the Oval and the floodgates were opened luckily all 11 indians were rescued but PRIDE died once again.
368it [00:58,  6.28it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-f6971cc7e1b04d10/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 133.00it/s]
100%|██████████| 1/1 [00:00<00:00, 57.52it/s]
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-f6971cc7e1b04d10/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Downloading data files: 100%|██████████| 1/1 [00:00<00:00, 943.18it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-907a0026c6b1b08f/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-907a0026c6b1b08f/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 127.96it/s]
100%|██████████| 1/1 [00:00<00:00, 96.90it/s]
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-2e478425c30c55b4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 142.97it/s]
100%|██████████| 1/1 [00:00<00:00, 88.09it/s]
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-2e478425c30c55b4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
embedding begin
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
torch.Size([3798, 30])
105.5
torch.Size([1055, 108])
./embeddings/NEW_bertie_embeddings_textattack/bert-base-uncased-MNLI_subset_1.pt
classify begin
738
158
159
  0%|          | 0/4 [00:00<?, ?it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
72it [00:05, 19.60it/s]                      bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
185it [00:16, 14.29it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
240it [00:27,  8.55it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
280it [00:39,  5.94it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
343it [00:39, 11.01it/s]bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
epoch number 3
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
test epoch results {'accuracy': 0.689873417721519, 'f1_weighted': 0.5882704134031207, 'f1_macro': 0.16881177365048336, 'f1': array([0.86021505, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.65909091]), 'precision': array([0.76923077, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.53703704]), 'recall': array([0.97560976, 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.85294118])}
Balancing rock! You have no idea how many steps I had to go up &amp; down for this picture...     http
lol shut up
Latest : Odisha flood: Situation in Hirakud improves; over 2 lakh still marooned - Odisha Sun Time... http Indian News
2 killed, 4 lakh affected in Bihar flood  http
Surya Ray Indian Nepal Floods Death Toll Passes 100 - Voice of America http  India
World_news Nepal and India begin relief efforts as monsoon floods claim at least 180 lives http
Nature ochry the brass unwritten that precious metals insistence regard india inflooding the back up station fl...
Hey MSM Flash flood in Gya, Ladhak do U guys even know about it?     http
180 dead as floods wash away homes in Nepal, India: Doctors inspect x-rays of landslide victims a... http India Health
A wonderful outpouring of the Holy Spirit today with my dear friend pastorluisrnegron... and I suited up http
372it [00:51,  7.20it/s]
Downloading data files: 100%|██████████| 1/1 [00:00<00:00, 941.48it/s]
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 144.01it/s]
Generating train split: 0 examples [00:00, ? examples/s]Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-672212cf3fc29f59/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-672212cf3fc29f59/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
100%|██████████| 1/1 [00:00<00:00, 52.27it/s]
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-7b49bc3d6388c31e/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-7b49bc3d6388c31e/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 141.71it/s]
100%|██████████| 1/1 [00:00<00:00, 110.98it/s]
Downloading data files: 100%|██████████| 1/1 [00:00<?, ?it/s]
Downloading and preparing dataset csv/default to C:/Users/admin/.cache/huggingface/datasets/csv/default-ba45f6ebade39859/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...
Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 141.69it/s]
100%|██████████| 1/1 [00:00<00:00, 99.99it/s]
Dataset csv downloaded and prepared to C:/Users/admin/.cache/huggingface/datasets/csv/default-ba45f6ebade39859/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.
embedding begin
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other
bertie_40_5e-5_wd_1e-2_run_1_seed_37_other_other

